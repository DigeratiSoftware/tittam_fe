(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98786,e=>{"use strict";var t=e.i(45042),s=e.i(18846);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function r({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...a})}function d({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>d,"CardDescription",()=>i,"CardHeader",()=>r,"CardTitle",()=>l])},57407,e=>{"use strict";let t=(0,e.i(80329).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>t],57407)},55010,e=>{"use strict";let t=(0,e.i(80329).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],55010)},86541,e=>{"use strict";var t=e.i(45042),s=e.i(97817),a=e.i(49572),r=s.forwardRef((e,s)=>(0,t.jsx)(a.Primitive.label,{...e,ref:s,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));r.displayName="Label";var l=e.i(18846);function i({className:e,...s}){return(0,t.jsx)(r,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...s})}e.s(["Label",()=>i],86541)},1508,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},95876,e=>{"use strict";var t=e.i(45042),s=e.i(18846);function a({className:e,type:a,...r}){return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}e.s(["Input",()=>a])},31737,e=>{"use strict";var t=e.i(45042),s=e.i(47937),a=e.i(48592),r=e.i(18846);function l({...e}){return(0,t.jsx)(s.Root,{"data-slot":"dialog",...e})}function i({...e}){return(0,t.jsx)(s.Portal,{"data-slot":"dialog-portal",...e})}function d({className:e,...a}){return(0,t.jsx)(s.Overlay,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...a})}function n({className:e,children:l,showCloseButton:n=!0,...o}){return(0,t.jsxs)(i,{"data-slot":"dialog-portal",children:[(0,t.jsx)(d,{}),(0,t.jsxs)(s.Content,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...o,children:[l,n&&(0,t.jsxs)(s.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(a.XIcon,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...s})}function u({className:e,...a}){return(0,t.jsx)(s.Title,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",e),...a})}function m({className:e,...a}){return(0,t.jsx)(s.Description,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}e.s(["Dialog",()=>l,"DialogContent",()=>n,"DialogDescription",()=>m,"DialogFooter",()=>c,"DialogHeader",()=>o,"DialogTitle",()=>u])},65218,e=>{"use strict";var t=e.i(97817);let s=0,a=new Map,r=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},l=[],i={toasts:[]};function d(e){i=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?r(s):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(i,e),l.forEach(e=>{e(i)})}function n({...e}){let t=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function o(){let[e,s]=t.useState(i);return t.useEffect(()=>(l.push(s),()=>{let e=l.indexOf(s);e>-1&&l.splice(e,1)}),[e]),{...e,toast:n,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}e.s(["toast",()=>n,"useToast",()=>o])},20648,e=>{"use strict";var t=e.i(50038);e.s(["X",()=>t.default])},38706,e=>{"use strict";let t=(0,e.i(80329).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],38706)},41408,e=>{"use strict";var t=e.i(45042),s=e.i(61808),a=e.i(7479),r=e.i(97817),l=e.i(38706);function i({children:e}){let{isAuthenticated:i,isLoading:d}=(0,s.useAuth)(),n=(0,a.useRouter)();return((0,r.useEffect)(()=>{d||i||n.push("/")},[i,d,n]),d)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):i?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["ProtectedRoute",()=>i,"default",()=>i])},32063,e=>{"use strict";let t=(0,e.i(80329).default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],32063)},65105,e=>{"use strict";let t=(0,e.i(80329).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>t],65105)},64034,e=>{"use strict";let t=(0,e.i(80329).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);e.s(["Filter",()=>t],64034)},264,e=>{"use strict";let t=(0,e.i(80329).default)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);e.s(["FileSpreadsheet",()=>t],264)},6660,e=>{"use strict";let t=(0,e.i(80329).default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);e.s(["List",()=>t],6660)},13659,82209,e=>{"use strict";let t=(0,e.i(80329).default)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);e.s(["Folder",()=>t],13659);let s=[{id:"1",title:"Project Documents",description:"All project-related documents",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",folders:[]},{id:"2",title:"Media Assets",description:"Images, videos, and design files",createdBy:"admin",createdAt:"2024-01-20T09:00:00Z",folders:[]}],a=[{id:"f1",folderId:"1",nestedFolderId:"nf1",fileName:"Service_Agreement_2024.pdf",fileType:"pdf",fileSize:2457600,uploadedBy:"admin",uploadedByName:"Admin User",uploadedAt:"2024-01-16T14:30:00Z",url:"/placeholder.pdf",zone:"North Zone",district:"Chennai",townPanchayat:"Ambattur"},{id:"f2",folderId:"1",nestedFolderId:"nf2",fileName:"Q1_Report_2024.pdf",fileType:"pdf",fileSize:1843200,uploadedBy:"user1",uploadedByName:"John Doe",uploadedAt:"2024-02-01T09:15:00Z",url:"/placeholder.pdf",zone:"West Zone",district:"Coimbatore",townPanchayat:"Singanallur"}],r=[{id:"nf1",name:"Reports",folderId:"1",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",shareConfig:{allowedFileTypes:["pdf","docx"],minFileSize:1,maxFileSize:10,accessType:"roles",allowedRoles:["admin","manager"]}},{id:"nf2",name:"Q1",folderId:"1",parentFolderId:"nf1",createdBy:"admin",createdAt:"2024-01-15T10:30:00Z"}];e.s(["driveService",0,{getFolders:async()=>s.map(e=>{var t;let s,a,l=(s=(t=r.filter(t=>t.folderId===e.id)).filter(e=>!e.parentFolderId),a=e=>{let s=t.filter(t=>t.parentFolderId===e.id);return{...e,folders:s.map(a)}},s.map(a));return{...e,folders:l}}),async createFolder(e){let t={...e,id:`folder_${Date.now()}`,createdAt:new Date().toISOString(),folders:[]};return s.push(t),t},async updateFolder(e,t){let a=s.findIndex(t=>t.id===e);if(-1!==a)return s[a]={...s[a],...t},s[a];throw Error("Folder not found")},async deleteFolder(e){s=s.filter(t=>t.id!==e),a=a.filter(t=>t.folderId!==e)},async getFiles(e,t,s){let r=a;return e&&(r=r.filter(t=>t.nestedFolderId===e)),t&&"admin"!==s&&"manager"!==s&&(r=r.filter(e=>e.uploadedBy===t)),r},async getAllFilesWithFilters(e){let t=a;return e.folderId&&(t=t.filter(t=>t.folderId===e.folderId)),e.nestedFolderId&&(t=t.filter(t=>t.nestedFolderId===e.nestedFolderId)),e.zone&&(t=t.filter(t=>t.zone===e.zone)),e.district&&(t=t.filter(t=>t.district===e.district)),e.townPanchayat&&(t=t.filter(t=>t.townPanchayat===e.townPanchayat)),t},async uploadFile(e){let t={...e,id:`file_${Date.now()}`,uploadedAt:new Date().toISOString()};return a.push(t),t},async deleteFile(e){a=a.filter(t=>t.id!==e)},getUserFileCount:async(e,t)=>a.filter(s=>s.nestedFolderId===e&&s.uploadedBy===t).length,async canUserUpload(e,t,a,l){let i=this.getEffectiveShareConfig(e,r,s);if(!i)return{canUpload:!1,reason:"Folder not found or not shared"};if("roles"===i.accessType){if(!i.allowedRoles?.includes(a))return{canUpload:!1,reason:"No access to this folder"}}else if("users"===i.accessType&&!i.allowedUserIds?.includes(t))return{canUpload:!1,reason:"No access to this folder"};let d=l.fileSize/1048576;return d<i.minFileSize||d>i.maxFileSize?{canUpload:!1,reason:`File size must be between ${i.minFileSize}MB and ${i.maxFileSize}MB`}:{canUpload:!0}},async getUserFileSummaries(e,t,s){let l=a;e&&(l=l.filter(t=>t.nestedFolderId===e)),t&&"admin"!==s&&"manager"!==s&&(l=l.filter(e=>e.uploadedBy===t));let i=new Map;l.forEach(e=>{let t=i.get(e.uploadedBy)||[];i.set(e.uploadedBy,[...t,e])});let d=[];for(let[e,t]of i.entries()){let s=t[0],a=r.find(e=>e.id===s.nestedFolderId),l=a?.shareConfig?.maxFileSize||0,i=t.length;d.push({userId:e,userName:s.uploadedByName,zone:s.zone,district:s.district,townPanchayat:s.townPanchayat,requestedCount:l,uploadedCount:i,pendingCount:Math.max(0,l-i),files:t,folderId:s.nestedFolderId||"",folderTitle:a?.name||""})}return d},async bulkDownloadFiles(e){let t=a.filter(t=>e.includes(t.id));console.log(`[v0] Downloading ${t.length} files as ZIP`);let s=`smart_drive_files_${new Date().toISOString().split("T")[0]}.zip`;return{success:!0,message:`Downloaded ${t.length} file(s) as ${s}`}},downloadAllFiles:async()=>(console.log("[v0] Downloading all files as ZIP"),{success:!0,message:`Downloaded ${a.length} files as all_files.zip`}),async downloadByFolder(e){let t=a.filter(t=>t.folderId===e),r=s.find(t=>t.id===e);return console.log(`[v0] Downloading ${t.length} files from folder ${r?.title}`),{success:!0,message:`Downloaded ${t.length} files from ${r?.title} as ${r?.title.replace(/\s+/g,"_")}.zip`}},async downloadByZone(e){let t=a.filter(t=>t.zone===e);return console.log(`[v0] Downloading ${t.length} files from zone ${e}`),{success:!0,message:`Downloaded ${t.length} files from ${e} as ${e.replace(/\s+/g,"_")}.zip`}},async downloadByDistrict(e){let t=a.filter(t=>t.district===e);return console.log(`[v0] Downloading ${t.length} files from district ${e}`),{success:!0,message:`Downloaded ${t.length} files from ${e} as ${e.replace(/\s+/g,"_")}.zip`}},async downloadByTownPanchayat(e){let t=a.filter(t=>t.townPanchayat===e);return console.log(`[v0] Downloading ${t.length} files from town panchayat ${e}`),{success:!0,message:`Downloaded ${t.length} files from ${e} as ${e.replace(/\s+/g,"_")}.zip`}},async createNestedFolder(e){let t={...e,id:`nfolder_${Date.now()}`,createdAt:new Date().toISOString(),folders:[]};return r.push(t),t},async updateNestedFolder(e,t){let s=r.findIndex(t=>t.id===e);if(-1!==s)return r[s]={...r[s],...t},r[s];throw Error("Nested folder not found")},async deleteNestedFolder(e){r=r.filter(t=>t.id!==e),a=a.filter(t=>t.nestedFolderId!==e)},getEffectiveShareConfig(e,t,s){let a=t.find(t=>t.id===e);if(!a)return null;if(a.shareConfig)return a.shareConfig;if(a.parentFolderId)return this.getEffectiveShareConfig(a.parentFolderId,t,s);if(s){let e=s.find(e=>e.id===a.folderId);if(e?.shareConfig)return e.shareConfig}return null},isFolderShared(e,t,s){let a=t.find(t=>t.id===e);if(!a)return{isShared:!1,isInherited:!1};if(a.shareConfig)return{isShared:!0,isInherited:!1};if(a.parentFolderId&&this.isFolderShared(a.parentFolderId,t,s).isShared)return{isShared:!0,isInherited:!0,inheritedFrom:"parent"};if(s){let e=s.find(e=>e.id===a.folderId);if(e?.shareConfig)return{isShared:!0,isInherited:!0,inheritedFrom:"databox"}}return{isShared:!1,isInherited:!1}}}],82209)},21224,e=>{"use strict";var t=e.i(45042),s=e.i(97817),a=e.i(41408),r=e.i(71429),l=e.i(53790),i=e.i(98786),d=e.i(57407),n=e.i(80329);let o=(0,n.default)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var c=e.i(6660);let u=(0,n.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var m=e.i(55010),x=e.i(97008),h=e.i(13659),f=e.i(1002),p=e.i(32063),g=e.i(65105),v=e.i(264),b=e.i(16020),y=e.i(64034),j=e.i(82209),w=e.i(61808),N=e.i(18846),F=e.i(87204),A=e.i(31737),S=e.i(95876),C=e.i(86541),k=e.i(20648);function D({open:e,onOpenChange:a,onSuccess:r,subfolder:i}){let{user:n}=(0,w.useAuth)(),[o,c]=(0,s.useState)([]),[u,m]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),[f,p]=(0,s.useState)({}),g=async e=>{if(e.preventDefault(),0!==o.length&&i&&n){h(""),m(!0),p({});try{let{canUpload:e,reason:t}=await j.driveService.canUserUpload(i.id,n.id,n.role);if(!e){h(t||"Cannot upload files"),m(!1);return}for(let e of o){let t=e.name.split(".").pop()?.toLowerCase()||"";e.size,p(t=>({...t,[e.name]:!0})),await j.driveService.uploadFile({subfolderId:i.id,folderId:i.folderId,fileName:e.name,fileType:t,fileSize:e.size,uploadedBy:n.id,uploadedByName:n.name,url:"/placeholder.svg?height=400&width=600",zone:"",district:"",townPanchayat:""})}r(),a(!1),c([]),p({})}catch(e){console.error("Failed to upload files:",e),h("Failed to upload files. Please try again.")}finally{m(!1)}}};return(0,t.jsx)(A.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(A.DialogContent,{className:"sm:max-w-[550px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(A.DialogHeader,{children:[(0,t.jsx)(A.DialogTitle,{className:"text-xl font-semibold text-[#013A65]",children:"Upload Files"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Upload to ",i?.title]})]}),i&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground bg-muted/30 px-3 py-2 rounded border",children:[(0,t.jsx)("span",{className:"font-medium text-[#013A65]",children:"Requirements:"})," ",i.allowedFileTypes.join(", ").toUpperCase()," • Max ",i.maxFileSize,"MB • Up to"," ",i.maxFilesPerUser," files"]}),(0,t.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[x&&(0,t.jsx)("div",{className:"p-2.5 bg-destructive/10 border border-destructive/20 text-destructive rounded text-sm",children:x}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{htmlFor:"fileInput",className:"text-sm font-medium text-[#013A65]",children:["Select Files ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)(S.Input,{id:"fileInput",type:"file",onChange:e=>{let t=Array.from(e.target.files||[]);if(0===t.length)return;let s=[],a="";for(let e of t){let t=e.name.split(".").pop()?.toLowerCase()||"",r=e.size/1048576;if(i&&!i.allowedFileTypes.includes(t)){a=`File ${e.name} has invalid type. Allowed: ${i.allowedFileTypes.join(", ")}`;break}if(i&&r>i.maxFileSize){a=`File ${e.name} exceeds max size of ${i.maxFileSize} MB`;break}s.push(e)}a?h(a):(c(e=>[...e,...s]),h(""))},accept:i?.allowedFileTypes.map(e=>`.${e}`).join(","),multiple:!0,className:"cursor-pointer h-10 text-sm file:mr-3 file:py-1.5 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium file:bg-[#F3B335] file:text-[#013A65] hover:file:bg-[#F3B335]/90"})]}),o.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C.Label,{className:"text-sm font-medium text-[#013A65]",children:["Selected Files (",o.length,")"]}),(0,t.jsx)("div",{className:"space-y-1.5 max-h-[250px] overflow-y-auto border rounded p-2 bg-muted/20",children:o.map((e,s)=>{let a=e.name.split(".").pop()?.toLowerCase()||"",r=f[e.name];return(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white border rounded hover:border-[#F3B335]/50 transition-colors",children:[(0,t.jsx)(b.FileText,{className:"h-4 w-4 text-[#013A65] flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-[#013A65] truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(e.size/1048576).toFixed(2)," MB • ",a.toUpperCase()]})]}),r?(0,t.jsx)("span",{className:"text-xs text-[#F3B335] font-medium",children:"Uploading..."}):(0,t.jsx)(l.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{c(e=>e.filter((e,t)=>t!==s))},disabled:u,className:"h-7 w-7 p-0 hover:bg-destructive/10 hover:text-destructive",children:(0,t.jsx)(k.X,{className:"h-3.5 w-3.5"})})]},`${e.name}-${s}`)})})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[(0,t.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>{a(!1),c([]),h("")},disabled:u,className:"min-w-[90px] h-9",children:"Cancel"}),(0,t.jsx)(l.Button,{type:"submit",disabled:u||0===o.length,className:"min-w-[110px] h-9 bg-gradient-to-r from-[#013A65] to-[#013A65]/90 hover:from-[#013A65]/90 hover:to-[#013A65]/80 text-white",children:u?`Uploading ${Object.keys(f).length}/${o.length}...`:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Upload,{className:"h-4 w-4 mr-2"}),"Upload ",o.length]})})]})]})]})})}let B=(0,n.default)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);function z({open:e,onOpenChange:s,userName:a,files:r}){let i=r||[];return(0,t.jsx)(A.Dialog,{open:e,onOpenChange:s,children:(0,t.jsxs)(A.DialogContent,{className:"max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,t.jsx)(A.DialogHeader,{children:(0,t.jsxs)(A.DialogTitle,{className:"text-xl font-bold text-[#013A65]",children:["Files Uploaded by ",a]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===i.length?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)(B,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"No files uploaded yet"})]}):(0,t.jsx)("div",{className:"space-y-3",children:i.map(e=>{var s;return(0,t.jsx)("div",{className:"bg-white border-l-4 border-[#F3B335] rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[(0,t.jsx)(B,{className:"h-5 w-5 text-[#013A65] flex-shrink-0 mt-1"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"font-medium text-[#013A65] mb-1 break-words",children:e.fileName}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[(0,t.jsx)("span",{className:"flex items-center gap-1",children:(0,t.jsx)("span",{className:"px-2 py-0.5 bg-[#F3B335]/20 text-[#013A65] rounded text-xs font-medium",children:e.fileType.toUpperCase()})}),(0,t.jsx)("span",{children:(s=e.fileSize)<1024?s+" B":s<1048576?(s/1024).toFixed(2)+" KB":(s/1048576).toFixed(2)+" MB"}),(0,t.jsx)("span",{children:new Date(e.uploadedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:(0,t.jsxs)("p",{children:[e.zone," • ",e.district," • ",e.townPanchayat]})})]})]}),(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>window.open(e.url,"_blank"),className:"text-[#013A65] border-[#013A65]/20 hover:bg-[#013A65]/10 flex-shrink-0",children:[(0,t.jsx)(g.Download,{className:"h-4 w-4 mr-1"}),"Download"]})]})},e.id)})})}),(0,t.jsx)("div",{className:"flex justify-end pt-4 border-t",children:(0,t.jsxs)(l.Button,{variant:"outline",onClick:()=>s(!1),children:[(0,t.jsx)(k.X,{className:"h-4 w-4 mr-2"}),"Close"]})})]})})}var I=e.i(65218);function T(){let{user:e}=(0,w.useAuth)(),{toast:n}=(0,I.useToast)(),[A,S]=(0,s.useState)([]),[C,k]=(0,s.useState)([]),[B,T]=(0,s.useState)(!0),[$,P]=(0,s.useState)(!1),[M,U]=(0,s.useState)(!1),[E,O]=(0,s.useState)("table"),[_,R]=(0,s.useState)(null),[L,Z]=(0,s.useState)(null),[q,V]=(0,s.useState)(!1),[H,X]=(0,s.useState)(null),[G,K]=(0,s.useState)(!1),[Q,W]=(0,s.useState)(new Set),[J,Y]=(0,s.useState)("all"),[ee,et]=(0,s.useState)(""),[es,ea]=(0,s.useState)(""),[er,el]=(0,s.useState)(""),[ei,ed]=(0,s.useState)(""),[en,eo]=(0,s.useState)(!1);(0,s.useEffect)(()=>{ec()},[]);let ec=async()=>{T(!0);try{let e=await j.driveService.getFolders();S(e);let t=new Set;e.forEach(e=>{t.add(e.id),eu(e.folders||[],t)}),W(t)}catch(e){console.error("Failed to load folders:",e)}finally{T(!1)}},eu=(e,t)=>{e.forEach(e=>{t.add(e.id),e.folders&&e.folders.length>0&&eu(e.folders,t)})},em=async t=>{P(!0);try{let s=await j.driveService.getUserFileSummaries(t,e?.id,e?.role);k(s)}catch(e){console.error("Failed to load data:",e),n({title:"Error loading data",description:"Failed to load folder data. Please try again.",variant:"destructive"})}finally{P(!1)}},ex=e=>{X(e),K(!0)},eh=e=>{W(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},ef=e=>!e.folders||0===e.folders.length,ep=(t,s)=>{let a=j.driveService.getEffectiveShareConfig(t.id,s);return!!a&&!!("all"===a.accessType||"roles"===a.accessType&&a.allowedRoles?.includes(e?.role)||"users"===a.accessType&&a.allowedUserIds?.includes(e?.id))},eg=(e,t)=>{let s=[];for(let a of e)if(ep(a,t)&&s.push(a),a.folders&&a.folders.length>0){let e=eg(a.folders,t);s.push(...e)}return s},ev=e=>{let t=[],s=e=>{for(let a of e)t.push(a),a.folders&&a.folders.length>0&&s(a.folders)};return s(e),t},eb=A.map(e=>{let t=ev(e.folders||[]);return{...e,folders:e.folders||[],allFolders:t}}).filter(e=>eg(e.folders,e.allFolders).length>0),ey=C.filter(e=>("completed"!==J||!(e.pendingCount>0))&&("pending"!==J||0!==e.pendingCount)&&(!ee||!!e.userName.toLowerCase().includes(ee.toLowerCase()))&&(!es||e.zone===es)&&(!er||e.district===er)&&(!ei||e.townPanchayat===ei)&&!0),ej=Array.from(new Set(C.map(e=>e.zone))),ew=Array.from(new Set(C.filter(e=>!es||e.zone===es).map(e=>e.district))),eN=Array.from(new Set(C.filter(e=>!er||e.district===er).map(e=>e.townPanchayat))),eF=e?.role==="admin"||e?.role==="manager",eA=async()=>{if(0===ey.length)return void n({title:"No files to download",description:"There are no files matching your current filters.",variant:"destructive"});U(!0);try{let e=[];for(let t of ey)t.files&&e.push(...t.files.map(e=>e.id));if(0===e.length)return void n({title:"No files to download",description:"The selected users have not uploaded any files yet.",variant:"destructive"});await j.driveService.bulkDownloadFiles(e),n({title:"Download started",description:`Downloading ${e.length} file(s) from selected folder`})}catch(e){console.error("Bulk download failed:",e),n({title:"Download failed",description:"Failed to download files. Please try again.",variant:"destructive"})}finally{U(!1)}},eS=(e,s,a=0)=>e.map(e=>{if(!ep(e,s))return null;let r=e.folders&&e.folders.length>0,l=Q.has(e.id),i=ef(e),d=L===e.id,n=j.driveService.isFolderShared(e.id,s);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{onClick:()=>{r&&eh(e.id),R(e.id),Z(e.id),em(e.id)},className:(0,N.cn)("w-full text-left px-3 py-2.5 rounded-lg text-sm transition-all flex items-center gap-2.5 group",d?"bg-[#013A65] text-white font-medium shadow-md":"text-[#013A65]/80 hover:bg-[#F3B335]/10 hover:text-[#013A65]"),style:{paddingLeft:`${16*a+12}px`},children:[r?l?(0,t.jsx)(f.ChevronDown,{className:"h-4 w-4 flex-shrink-0"}):(0,t.jsx)(p.ChevronRight,{className:"h-4 w-4 flex-shrink-0"}):(0,t.jsx)("div",{className:"w-4"}),i?(0,t.jsx)(x.FolderOpen,{className:(0,N.cn)("h-4 w-4 flex-shrink-0",d?"text-[#F3B335]":"text-[#013A65]")}):(0,t.jsx)(h.Folder,{className:(0,N.cn)("h-4 w-4 flex-shrink-0",d?"text-[#F3B335]":"text-[#013A65]")}),(0,t.jsx)("span",{className:"truncate flex-1",children:e.name}),n.isShared&&(0,t.jsx)("span",{className:(0,N.cn)("text-[10px] font-medium px-2 py-0.5 rounded-full",n.isInherited?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700",d&&"bg-white/20 text-white"),children:n.isInherited?"Inherited":"Shared"})]}),r&&l&&(0,t.jsx)("div",{className:"mt-0.5",children:eS(e.folders,s,a+1)})]},e.id)});return(0,t.jsx)(a.ProtectedRoute,{children:(0,t.jsxs)(r.DashboardLayout,{children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-[#013A65] to-[#013A65]/90 rounded-lg py-3 px-6 text-white shadow-lg",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"Smart Drive"}),(0,t.jsx)("p",{className:"text-white/80 text-sm mt-1",children:"Upload and manage files by databox and shares"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Button,{variant:"grid"===E?"default":"outline",size:"sm",onClick:()=>O("grid"),className:(0,N.cn)("h-9 border-white/20","grid"===E?"bg-[#F3B335] text-[#013A65] hover:bg-[#F3B335]/90":"bg-green-600 text-white hover:bg-green-700"),children:(0,t.jsx)(o,{className:"h-4 w-4"})}),(0,t.jsx)(l.Button,{variant:"table"===E?"default":"outline",size:"sm",onClick:()=>O("table"),className:(0,N.cn)("h-9 border-white/20","table"===E?"bg-[#F3B335] text-[#013A65] hover:bg-[#F3B335]/90":"bg-green-600 text-white hover:bg-green-700"),children:(0,t.jsx)(c.List,{className:"h-4 w-4"})}),eF&&(0,t.jsx)(F.default,{href:"/dashboard/drive/manage",children:(0,t.jsxs)(l.Button,{size:"sm",className:"bg-gradient-to-r from-[#F3B335] to-[#F3B335]/90 hover:from-[#F3B335]/90 hover:to-[#F3B335]/80 text-[#013A65] border-0 shadow-lg hover:shadow-xl transition-all duration-300 h-9 px-4 text-sm font-medium",children:[(0,t.jsx)(u,{className:"h-4 w-4 mr-1.5"}),"Manage Databox"]})}),L&&(()=>{if(!L)return!1;for(let e of eb){let t=ev(e.folders||[]).find(e=>e.id===L);if(t)return ef(t)}return!1})()&&(0,t.jsxs)(l.Button,{onClick:()=>V(!0),size:"sm",className:"bg-gradient-to-r from-[#F3B335] to-[#F3B335]/90 hover:from-[#F3B335]/90 hover:to-[#F3B335]/80 text-[#013A65] border-0 shadow-lg hover:shadow-xl transition-all duration-300 h-9 px-4 text-sm font-medium",children:[(0,t.jsx)(d.Upload,{className:"h-4 w-4 mr-1.5"}),"Upload Files"]})]})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search by user name...",value:ee,onChange:e=>et(e.target.value),className:"h-11 px-4 border border-[#013A65]/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#013A65]/20 focus:border-[#013A65] text-sm min-w-[280px] flex-1"}),(0,t.jsx)(l.Button,{variant:"all"===J?"default":"outline",size:"sm",onClick:()=>Y("all"),className:(0,N.cn)("h-11 px-6","all"===J?"bg-[#013A65] text-white hover:bg-[#013A65]/90":"border-[#013A65]/20 text-[#013A65] hover:bg-[#013A65]/10"),children:"All"}),(0,t.jsx)(l.Button,{variant:"completed"===J?"default":"outline",size:"sm",onClick:()=>Y("completed"),className:(0,N.cn)("h-11 px-6","completed"===J?"bg-green-600 text-white hover:bg-green-700":"border-[#013A65]/20 text-green-600 hover:bg-green-50"),children:"Completed"}),(0,t.jsx)(l.Button,{variant:"pending"===J?"default":"outline",size:"sm",onClick:()=>Y("pending"),className:(0,N.cn)("h-11 px-6","pending"===J?"bg-orange-600 text-white hover:bg-orange-700":"border-[#013A65]/20 text-orange-600 hover:bg-orange-50"),children:"Pending"}),(0,t.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>eo(!en),className:(0,N.cn)("h-11 px-4 ml-auto",en?"bg-[#013A65] text-white hover:bg-[#013A65]/90":"border-[#013A65]/20 text-[#013A65] hover:bg-[#013A65]/10"),children:(0,t.jsx)(y.Filter,{className:"h-4 w-4"})})]}),en&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)("select",{value:es,onChange:e=>{ea(e.target.value),el(""),ed("")},className:"h-11 px-4 border border-[#013A65]/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#013A65]/20 focus:border-[#013A65] text-sm min-w-[280px]",children:[(0,t.jsx)("option",{value:"",children:"All Zones"}),ej.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:er,onChange:e=>{el(e.target.value),ed("")},disabled:!es,className:"h-11 px-4 border border-[#013A65]/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#013A65]/20 focus:border-[#013A65] text-sm min-w-[280px] disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"",children:"All Districts"}),ew.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:ei,onChange:e=>ed(e.target.value),disabled:!er,className:"h-11 px-4 border border-[#013A65]/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#013A65]/20 focus:border-[#013A65] text-sm min-w-[280px] disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"",children:"All Town Panchayats"}),eN.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsx)(i.Card,{className:"border-border bg-card",children:(0,t.jsx)(i.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex gap-6",children:[(0,t.jsxs)("div",{className:"w-72 border-l-4 border-[#F3B335] border-t border-r border-b border-border rounded-lg p-4 bg-gradient-to-b from-white to-gray-50/50 max-h-[calc(100vh-300px)] overflow-y-auto",children:[(0,t.jsxs)("h3",{className:"font-semibold text-[#013A65] mb-4 text-base flex items-center gap-2",children:[(0,t.jsx)(h.Folder,{className:"h-5 w-5 text-[#F3B335]"}),"Databox Tree"]}),B?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Loading folders..."}):0===eb.length?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,t.jsx)(x.FolderOpen,{className:"h-10 w-10 mx-auto mb-3 opacity-30"}),(0,t.jsx)("p",{children:"No accessible folders"})]}):(0,t.jsx)("div",{className:"space-y-1",children:eb.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{onClick:()=>eh(e.id),className:(0,N.cn)("w-full text-left px-3 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center gap-2.5","text-[#013A65] hover:bg-[#F3B335]/10 hover:text-[#013A65] border border-transparent hover:border-[#F3B335]/20"),children:[Q.has(e.id)?(0,t.jsx)(f.ChevronDown,{className:"h-4 w-4 flex-shrink-0"}):(0,t.jsx)(p.ChevronRight,{className:"h-4 w-4 flex-shrink-0"}),(0,t.jsx)(h.Folder,{className:"h-4 w-4 flex-shrink-0 text-[#F3B335]"}),(0,t.jsx)("span",{className:"truncate flex-1",children:e.title})]}),Q.has(e.id)&&e.folders&&e.folders.length>0&&(0,t.jsx)("div",{className:"mt-0.5 space-y-0.5 ml-1",children:eS(e.folders,e.allFolders,0)})]},e.id))})]}),(0,t.jsx)("div",{className:"flex-1",children:$?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#013A65] mx-auto mb-4"}),(0,t.jsx)("p",{children:"Loading folder data..."})]}):L?0===ey.length?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)(x.FolderOpen,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"No files uploaded yet in this folder."})]}):"grid"===E?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ey.map(e=>(0,t.jsxs)("div",{className:"border-l-4 border-[#F3B335] border-t border-r border-b border-border rounded-lg p-4 hover:shadow-md transition-all bg-white",children:[(0,t.jsx)("h4",{className:"font-semibold text-[#013A65] mb-3",children:e.userName}),(0,t.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Zone:"}),(0,t.jsx)("span",{className:"font-medium text-[#013A65]",children:e.zone})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"District:"}),(0,t.jsx)("span",{className:"font-medium text-[#013A65]",children:e.district})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Town Panchayat:"}),(0,t.jsx)("span",{className:"font-medium text-[#013A65]",children:e.townPanchayat})]}),(0,t.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Requested:"}),(0,t.jsx)("span",{className:"font-medium",children:e.requestedCount})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Uploaded:"}),(0,t.jsx)("span",{className:"font-medium text-green-600",children:e.uploadedCount})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Pending:"}),(0,t.jsx)("span",{className:"font-medium text-orange-600",children:e.pendingCount})]})]})]}),(0,t.jsxs)(l.Button,{onClick:()=>ex(e),className:"w-full bg-[#013A65] hover:bg-[#013A65]/90 text-white",size:"sm",children:[(0,t.jsx)(m.Eye,{className:"h-4 w-4 mr-2"}),"View Files"]})]},e.userId))}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[eF&&(0,t.jsxs)(l.Button,{onClick:eA,disabled:M||0===ey.length,size:"sm",className:"bg-gradient-to-r from-green-600 to-green-600/90 hover:from-green-600/90 hover:to-green-600/80 text-white",children:[(0,t.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),M?"Downloading...":"Bulk File Downloads"]}),(0,t.jsxs)(l.Button,{onClick:()=>{if(0===ey.length)return void n({title:"No data to export",description:"There are no records matching your current filters.",variant:"destructive"});let e=["User Name,Zone,District,Town Panchayat,Requested,Uploaded,Pending"];ey.forEach(t=>{let s=[`"${t.userName}"`,`"${t.zone}"`,`"${t.district}"`,`"${t.townPanchayat}"`,t.requestedCount,t.uploadedCount,t.pendingCount];e.push(s.join(","))});let t=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),a=URL.createObjectURL(t);s.setAttribute("href",a),s.setAttribute("download",`smart-drive-report-${new Date().toISOString().split("T")[0]}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),n({title:"Excel export successful",description:`Exported ${ey.length} records to CSV file.`})},disabled:0===ey.length,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,t.jsx)(v.FileSpreadsheet,{className:"h-4 w-4 mr-2"}),"Export Excel"]}),(0,t.jsxs)(l.Button,{onClick:()=>{0===ey.length?n({title:"No data to export",description:"There are no records matching your current filters.",variant:"destructive"}):(n({title:"PDF export started",description:`Generating PDF with ${ey.length} records...`}),setTimeout(()=>{n({title:"PDF export successful",description:`Exported ${ey.length} records to PDF file.`})},1e3))},disabled:0===ey.length,size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",children:[(0,t.jsx)(b.FileText,{className:"h-4 w-4 mr-2"}),"Export PDF"]})]}),(0,t.jsx)("div",{className:"border-l-4 border-[#F3B335] border-t border-r border-b border-border rounded-lg overflow-hidden bg-white",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-[#F3B335]",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left px-4 py-3 text-sm font-semibold min-w-[150px] text-[#013A65]",children:"User Name"}),(0,t.jsx)("th",{className:"text-left px-4 py-3 text-sm font-semibold min-w-[120px] text-[#013A65]",children:"Zone"}),(0,t.jsx)("th",{className:"text-left px-4 py-3 text-sm font-semibold min-w-[120px] text-[#013A65]",children:"District"}),(0,t.jsx)("th",{className:"text-left px-4 py-3 text-sm font-semibold min-w-[150px] text-[#013A65]",children:"Town Panchayat"}),(0,t.jsx)("th",{className:"text-center px-4 py-3 text-sm font-semibold w-24 text-[#013A65]",children:"Requested"}),(0,t.jsx)("th",{className:"text-center px-4 py-3 text-sm font-semibold w-24 text-[#013A65]",children:"Uploaded"}),(0,t.jsx)("th",{className:"text-center px-4 py-3 text-sm font-semibold w-24 text-[#013A65]",children:"Pending"}),(0,t.jsx)("th",{className:"text-center px-4 py-3 text-sm font-semibold w-28 text-[#013A65]",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:ey.map((e,s)=>(0,t.jsxs)("tr",{className:(0,N.cn)("border-b border-gray-100 hover:bg-[#F3B335]/5 transition-colors",s%2==0?"bg-white":"bg-gray-50/50"),children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-[#013A65] font-medium",children:(0,t.jsx)("div",{className:"truncate max-w-[200px]",title:e.userName,children:e.userName})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:(0,t.jsx)("div",{className:"truncate max-w-[120px]",title:e.zone,children:e.zone})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:(0,t.jsx)("div",{className:"truncate max-w-[120px]",title:e.district,children:e.district})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:(0,t.jsx)("div",{className:"truncate max-w-[150px]",title:e.townPanchayat,children:e.townPanchayat})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-center font-medium",children:e.requestedCount}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-center font-medium text-green-600",children:e.uploadedCount}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-center font-medium text-orange-600",children:e.pendingCount}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:()=>ex(e),className:"text-[#013A65] hover:bg-[#013A65]/10",children:[(0,t.jsx)(m.Eye,{className:"h-4 w-4 mr-1"}),"View"]})})]},e.userId))})]})})})]}):(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)(x.FolderOpen,{className:"h-16 w-16 mx-auto mb-4 opacity-30 text-[#013A65]"}),(0,t.jsx)("p",{className:"text-lg font-medium text-[#013A65] mb-2",children:"Select a Folder"}),(0,t.jsx)("p",{className:"text-sm",children:"Choose a folder from the tree to view uploaded files"})]})})]})})})]}),(0,t.jsx)(D,{open:q,onOpenChange:V,folders:A,onUploadComplete:()=>{L&&em(L)}}),(0,t.jsx)(z,{open:G,onOpenChange:K,userSummary:H,onFileDeleted:()=>{L&&em(L)}})]})})}e.s(["default",()=>T],21224)}]);